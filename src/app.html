<!doctype html>
<html lang="fr">
    <head>
        <meta charset="utf-8" />
        <link rel="icon" href="%sveltekit.assets%/favicon.png" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="manifest" href="%sveltekit.assets%/manifest.json" />
        %sveltekit.head%
        <style>
            #boot-loader {
                position: fixed;
                inset: 0;
                z-index: 2147483647;
                display: grid;
                place-items: center;
                overflow: hidden;
                background: var(--background);
                color: var(--foreground);
                font:
                    14px system-ui,
                    sans-serif;
                transition: opacity 0.2s ease;
            }
            #boot-wrap {
                display: flex;
                flex-direction: column;
                gap: 0.75rem;
                align-items: center;
            }
            .spinner {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                border: 3px solid var(--muted-foreground);
                border-top-color: var(--primary);
                animation: spin 1s linear infinite;
            }
            #boot-msg {
                opacity: 0.8;
            }
            @keyframes spin {
                to {
                    transform: rotate(360deg);
                }
            }
        </style>
    </head>
    <body
        data-sveltekit-preload-data="hover"
        class="dark">
        <div id="boot-loader">
            <div id="boot-wrap" class="relative">
                <img src="%sveltekit.assets%/logo_small.png" alt="Logo" width="40" height="auto" />
                <div class="spinner absolute" role="img" aria-label="Chargement"></div>
            </div>
        </div>

        <div style="display: contents">%sveltekit.body%</div>

        <script>
            // Hide API, sera appellée dans hooks.client.ts (init)
            window.__hideBoot = function () {
                const el = document.getElementById("boot-loader");
                if (!el) return;
                el.style.opacity = "0";
                el.addEventListener("transitionend", () => el.remove(), { once: true });
                //setTimeout(() => el && el.remove(), 300);
            };

            // Failsafe ultime au cas où
            setTimeout(() => window.__hideBoot?.(), 8000);
        </script>
    </body>
</html>
